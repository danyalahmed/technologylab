---
# ============================================================================
# CONFIGURE KUBERNETES NODES
# ============================================================================
# This playbook prepares all nodes (control plane and workers) for Kubernetes.
# It configures firewall, system settings, container runtime, and installs
# Kubernetes components.
#
# Roles applied:
#   - firewall: Configure UFW firewall rules
#   - system-prep: Disable swap, load kernel modules, set sysctl
#   - container-runtime: Install and configure containerd
#   - kubernetes: Install kubeadm, kubelet, kubectl
#   - networking: Apply network fixes for Calico VXLAN
#
# Prerequisites:
#   - Python dependencies installed (00-Prerequisites.yml)
#   - SSH access to all nodes
#   - sudo privileges on all nodes
#
# Usage:
#   ansible-playbook -i hosts.ini playbooks/01-Configure-nodes.yml
# ============================================================================

- name: Prepare Nodes for Kubernetes
  hosts: k8s_nodes
  become: true
  become_method: ansible.builtin.sudo
  strategy: free

  roles:
    - firewall
    - system-prep
    - container-runtime
    - kubernetes
    - networking
